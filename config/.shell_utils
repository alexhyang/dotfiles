#!/bin/bash
# shell
showPath () {
  echo $PATH | sed -E "s/:/\n/g"
}

# note-taking
createmd () {
  if [[ -d "$HOME/research-notes" ]]; then
    cp ~/research-notes/template.md $1.md;
    echo "$1.md created";
  else
    echo "research notes repo not cloned on local machine";
  fi
}

readme () {
  if [[ -f "./README.md" ]]; then
    vim ./README.md;
  else
    promptMessage="README.md doesn't exit! Create README.md? [y/N]: "
    if [[ $SHELL == "/usr/bin/zsh" ]]; then
      read "confirm?$promptMessage"
    else
      read -p $promptMessage confirm
    fi
    if [[ $confirm =~ ^[Yy]$ ]]; then
      createmd README || touch README.md && vim README.md;
    fi
  fi
}

# help files and references
tl () {
  tldr $1 -t base16 || echo "Install tldr: npm install -g tldr"
}

myrefs () {
  if [[ $# -eq 1 ]]; then
    refname="$1"
  else
    flag="$1"
    refname="$2"
  fi
  refpath="$HOME/.dotfiles/refs/$refname.md"
  if [[ -f $refpath ]]; then
    case $flag in
      -e)
        vim $refpath
        ;;
      *)
        bat $refpath
        ;;
    esac
  else
    promptMessage="Requested ref doesn't exist! Create $refname.md? [y/N]"
    if [[ $SHELL == "/usr/bin/zsh" ]]; then
      read "confirm?$promptMessage"
    else
      read -p $promptMessage confirm
    fi
    if [[ $confirm =~ ^[Yy]$ ]]; then
      createmd $refname && vim $refpath;
    fi
  fi
}

# drop or publish files
dropNotes () {
  dropbox="$HOME/research-notes/dropbox";
  if [[ ! -f $dropbox/$1 ]]; then
    mv ./$1 $dropbox/$1
  else
    if ! diff $dropbox/$1 ./$1; then
      promptMessage="./$1 --> $dropbox/$1? [y/N]"
      if [[ $SHELL == "/usr/bin/zsh" ]]; then
        read "confirm?$promptMessage"
      else
        read -p $promptMessage confirm
      fi
      if [[ $confirm =~ ^[Yy]$ ]]; then
        mv ./$1 $dropbox/$1
      else
        echo "dropNotes cancelled"
      fi
    else
      echo "No difference between $1 and $dropbox/$1. DropNotes cancelled."
    fi
  fi
}
